package com.demo.linkedList;

public class DoublyCircularLinkedList {
	Node head;
	class Node{
		int data;
		Node next;
		Node prev;
		public Node(int data) {
			super();
			this.data = data;
			next = null;
			prev = null;
		}
		
	}
	public DoublyCircularLinkedList()
	{
		head = null;
	}
	public void addNode(int val)
	{
		Node newNode = new Node(val);
		if(head==null)
		{
			head=newNode;
			head.prev = head;
			head.next = head;
		}
		else {
			Node temp = head;
			while(temp.next!=head)
			{
				temp = temp.next;
			}
			newNode.prev =temp;
			newNode.next = temp.next;
			temp.next =newNode;
			head.prev=newNode;
		}
	}
	public void display()
	{
		Node temp = head;
		do {
			System.out.print(temp.data +"--->");
			temp = temp.next;
		}while(temp!=head);
		System.out.println();
	}
	public void addByvalue(int val,int data)
	{
		Node newNode = new Node(data);
		if(head ==null)
		{
			System.out.println("list is empty");
		}
		else if(head.data==val){
			newNode.next = head.next;
			newNode.prev = head;
			head.next = newNode;
			head.prev=newNode;
		}
		else
		{
			Node temp = head;
			while(temp.next!=head && temp.data!=val)
			{
				temp = temp.next;
				
			}
			if(temp.data ==val)
			{
				newNode.next = temp.next;
				newNode.prev = temp;
				temp.next = newNode;
				head.prev=newNode;
			}
			else {
				System.out.println("value is not found");
			}
			
		}
	}
	public void addByPosition(int val,int pos)
	{
		Node newNode = new Node(val);
		if(head==null)
		{
			System.out.println("list is empty");
		}
		else if(pos==1)
		{
			newNode.next = head;
			newNode.prev = head.prev;
		    head.prev.next=newNode;
			head.prev=newNode;
			head = newNode;
		}
		else {
			Node temp = head;
			int i =0;
			while(temp.next!=head && i<pos-2)
			{
				temp = temp.next;
				i++;
			}
			if(i==pos-2)
			{
				newNode.next = temp.next;
				newNode.prev = temp;
				temp.next=newNode;
			}
			else {
				System.out.println("position is out of bound");
			}
			
		}
	}
	public void deleteByvalue(int val)
	{
		
		if(head==null)
		{
			System.out.println("list is empty");
		}
		else if(head.data==val)
		{
			head.prev.next = head.next; 
			head.next.prev = head.prev;
			head = head.next;
		
		}
		
		else
		{
			Node temp = head;
			while(temp.next!=head && temp.data !=val)
			{
				temp=temp.next;
			}
			if(temp.data==val)
			{
				temp.prev.next=temp.next;
				temp.next.prev=temp.prev;
			}
			else
			{
				System.out.println("Data is not found");
			}
			
		}
	}
	
	public void deleteByPosition(int pos)
	{
		if(head==null)
		{
			System.out.println("list is empty");
		}
		else if(pos==1)
		{
			head.prev.next = head.next; 
			head.next.prev = head.prev;
			head = head.next;
		}
		
		else
		{
			Node temp = head;
			int i=1;
			while(temp!=head && i<=pos-1)
			{
				temp=temp.next;
			}
			if(i==pos-1)
			{
				temp.prev.next=temp.next;
				temp.next.prev=temp.prev;
			}
			else
			{
				System.out.println("position is not found");
			}
			
		}
	}
}
